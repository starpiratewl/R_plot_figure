## add lines according to different groups
## actually there are four lines here , but every two lines have the same height, so they seem to be one line.

dat <- read.table(header=TRUE, text='
     cond group result hline
  control     A     10     9
treatment     A   11.5    12
  control     B     12     9
treatment     B     14    12
')

dat
#       cond group result hline
#1   control     A   10.0     9
#2 treatment     A   11.5    12
#3   control     B   12.0     9
#4 treatment     B   14.0    12


# Define basic bar plot
bp <- ggplot(dat, aes(x=cond, y=result, fill=group)) +
    geom_bar(position=position_dodge(), stat="identity")
bp


# The error bars get plotted over one another -- there are four but it looks
# like two
bp + geom_errorbar(aes(y=hline, ymax=hline, ymin=hline), linetype="dashed")


## add lines according to different groups
## there are four lines here, each line has a different height

dat <- read.table(header=TRUE, text='
     cond group result hline
  control     A     10    11
treatment     A   11.5    12
  control     B     12  12.5
treatment     B     14    15
')

# Define basic bar plot
bp <- ggplot(dat, aes(x=cond, y=result, fill=group)) +
    geom_bar(position=position_dodge(), stat="identity")
bp

bp + geom_errorbar(aes(y=hline, ymax=hline, ymin=hline), linetype="dashed", position=position_dodge())



## add lines to continuous data

dat <- read.table(header=TRUE, text='
      cond xval yval
   control 11.5 10.8
   control  9.3 12.9
   control  8.0  9.9
   control 11.5 10.1
   control  8.6  8.3
   control  9.9  9.5
   control  8.8  8.7
   control 11.7 10.1
   control  9.7  9.3
   control  9.8 12.0
 treatment 10.4 10.6
 treatment 12.1  8.6
 treatment 11.2 11.0
 treatment 10.0  8.8
 treatment 12.9  9.5
 treatment  9.1 10.0
 treatment 13.4  9.6
 treatment 11.6  9.8
 treatment 11.5  9.8
 treatment 12.0 10.6
')

library(ggplot2)

# basic scatter plot
sp <- ggplot(dat, aes(x=xval, y=yval, colour=cond)) + geom_point()

# horizontal line
sp + geom_hline(aes(yintercept=10))

# vertical line
sp + geom_hline(aes(yintercept=10)) + geom_vline(aes(xintercept=11.5), colour="#BB0000", linetype="dashed")

# Add colored lines for the mean xval of each group
sp + geom_hline(aes(yintercept=10)) + geom_line(stat="vline", xintercept="mean")


# facid according to "cond" variable
spf <- sp + facet_grid(. ~ cond)
spf


# draw lines on all the facets
spf + geom_hline(aes(yintercept=10))


# draw different lines on different facets
## method 1
dat_vlines <- data.frame(cond=levels(factor(dat$cond)), xval=c(10,11.5))
dat_vlines

spf + geom_hline(aes(yintercept=10)) + geom_vline(aes(xintercept=xval), data=dat_vlines, colour="#990000", linetype="dashed")

## method 2
spf + geom_hline(aes(yintercept=10)) + geom_line(stat="vline", xintercept="mean")
                    
                    









